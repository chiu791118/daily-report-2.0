"""
Layer 0-5 Prompts for Pre-Market Report
"""

# ============================================================================
# LLM Call 1: Hidden Layer + Layer 0-1
# ============================================================================

LAYER_0_1_PROMPT = """你是一位頂尖的投資研究分析師，正在生成盤前報告的 Layer 0 和 Layer 1。

## Hidden Layer 處理結果
{hidden_layer_output}

## 今日市場數據
{market_data}

## 今日新聞
{news_data}

---

## 請生成以下內容：

### Layer 0: Executive Snapshot（固定 5 區塊）

生成簡潔的執行摘要，每個區塊 1-2 行：

**1. 市場情緒**
[🟢/🟡/🔴] [一句話描述當前市場情緒及 VIX 水平]

**2. 宏觀焦點**
[今日最重要的宏觀事件/數據，及其市場影響]

**3. 科技/AI 動態**
[科技板塊或 AI 相關的關鍵發展]

**4. 行業亮點**
[今日值得關注的行業動態或公司新聞]

**5. 風險提醒**
[當前需要注意的主要風險因素]

{yesterday_warning}

---

### Layer 1: What Changed Today（變化識別）

根據 Hidden Layer 的處理結果，分類呈現今日變化：

**🌍 宏觀/政策層面**
- [變化類型標籤] 變化描述及影響
- ...

**🏭 行業/板塊層面**
- [變化類型標籤] 變化描述及影響
- ...

**🏢 公司層面**
- [變化類型標籤] 公司代碼: 變化描述及影響
- ...

變化類型標籤：
- 🔄 延續：昨日主題今日持續
- ⚡ 反轉：預期與結果相反
- 🆕 新發現：今日新出現的重要資訊

---

## 輸出要求
1. 語言：繁體中文
2. Layer 0 每個區塊限制 1-2 行
3. Layer 1 每個層面列出 2-4 個最重要的變化
4. 所有內容必須基於提供的數據，不要編造
"""

# ============================================================================
# LLM Call 2: Layer 2-3
# ============================================================================

LAYER_2_3_PROMPT = """你是一位頂尖的投資研究分析師，正在生成盤前報告的 Layer 2 和 Layer 3。

## 前序報告內容
### Layer 0: Executive Snapshot
{layer_0_content}

### Layer 1: What Changed Today
{layer_1_content}

## 市場數據
{market_data}

---

## 請生成以下內容：

### Layer 2: Structural Interpretation（結構性推斷）

基於 Layer 0-1 的變化識別，提出**最多 3 條**結構性推斷。

每條推斷必須包含：
1. **推斷內容**：對市場結構或趨勢的判斷
2. **支持證據**：來自 Layer 0-1 的具體依據
3. **反駁條件**：什麼情況下這個推斷會失效
4. **投資意涵**：對資產配置或個股選擇的具體建議

格式：
**推斷 1: [推斷標題]**
- 內容：...
- 依據：...
- 反駁條件：...
- 投資意涵：...

---

#### Quality Gate 自檢

對每條推斷進行自檢：
| 推斷 | 是否有具體依據 | 是否可證偽 | 是否有明確時間框架 | 通過 |
|------|--------------|----------|-----------------|------|
| 推斷1 | ✅/❌ | ✅/❌ | ✅/❌ | ✅/❌ |
| 推斷2 | ✅/❌ | ✅/❌ | ✅/❌ | ✅/❌ |
| 推斷3 | ✅/❌ | ✅/❌ | ✅/❌ | ✅/❌ |

未通過 Quality Gate 的推斷應被刪除或修改。

---

### Layer 3: Asset Allocation Watchlist（配置狀態燈）

根據 Layer 2 的推斷，給出資產類別的配置建議：

| 資產類別 | 狀態 | 建議行動 | 理由 |
|---------|------|---------|------|
| 美股大盤 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |
| 科技股 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |
| 防禦股 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |
| 債券 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |
| 商品 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |
| 現金 | 🟢/🟡/🔴 | 加碼/持有/減碼 | 簡短理由 |

狀態說明：
- 🟢 綠燈：環境有利，可積極配置
- 🟡 黃燈：中性或觀望，維持現有配置
- 🔴 紅燈：環境不利，考慮減碼或避開

---

## 輸出要求
1. 語言：繁體中文
2. Layer 2 嚴格限制最多 3 條推斷
3. 每條推斷必須通過 Quality Gate
4. Layer 3 的狀態燈必須與 Layer 2 的推斷一致
"""

# ============================================================================
# LLM Call 3: Layer 4-5 + News Summary
# ============================================================================

LAYER_4_5_PROMPT = """你是一位頂尖的投資研究分析師，正在生成盤前報告的 Layer 4 和 Layer 5。

## 前序報告內容
### Layer 0: Executive Snapshot
{layer_0_content}

### Layer 1: What Changed Today
{layer_1_content}

### Layer 2: Structural Interpretation
{layer_2_content}

### Layer 3: Asset Allocation Watchlist
{layer_3_content}

## 觀察名單股票數據
{watchlist_data}

## Hidden Layer 識別的公司變化
{company_changes}

---

## 請生成以下內容：

### Layer 4: Equity Signals（個股信號）

#### 4A: 觀察名單觸發

從觀察名單中，列出今日有信號觸發的標的：

| 代碼 | 觸發原因 | 信號類型 | 建議行動 |
|------|---------|---------|---------|
| XXXX | 具體觸發原因 | 技術/基本面/新聞 | 觀察/買入/賣出 |

觸發條件：
- 技術面：突破關鍵價位、RSI 極值、成交量異常
- 基本面：財報、指引調整、評級變動
- 新聞面：重大公告、監管動態、產業事件

#### 4B: 新聞驅動發現

根據今日新聞，識別觀察名單外值得關注的標的：

| 代碼 | 新聞事件 | 潛在影響 | 是否納入觀察 |
|------|---------|---------|-------------|
| XXXX | 具體新聞事件 | 對股價的潛在影響 | 是/否 |

---

### Layer 5: Decision Log（判斷記錄）

用 3 行記錄今日的關鍵判斷，供未來回顧：

1. **市場判斷**：[對今日市場的核心判斷，包含方向和理由]
2. **操作建議**：[具體的操作建議，包含標的和價位]
3. **待驗證假設**：[需要在未來驗證的假設，包含驗證條件]

---

## 輸出要求
1. 語言：繁體中文
2. 4A 只列出有明確信號的標的（不要列出「無觸發」的股票）
3. 4B 限制 3-5 個最重要的新發現
4. Layer 5 嚴格限制 3 行
5. 所有股票代碼使用美股格式（如 AAPL, NVDA）
"""

# ============================================================================
# News Summary Prompt
# ============================================================================

NEWS_SUMMARY_PROMPT = """你是一位財經新聞編輯，正在撰寫今日新聞摘要。

## 今日新聞
{news_data}

## 市場數據
{market_data}

---

## 請生成段落式新聞摘要

要求：
1. 300-500 字的連貫段落（非條列式）
2. 按重要性排序，最重要的放前面
3. 涵蓋：市場表現、宏觀動態、科技趨勢、重要公司新聞
4. 語言流暢，適合快速閱讀
5. 使用繁體中文

格式範例：
「美股週四延續漲勢，標普500指數再創歷史新高。科技股領漲，輝達財報超預期推動AI概念股全線走強。宏觀面上，最新就業數據顯示勞動力市場維持穩健，但通膨壓力略有回升...」

請直接輸出段落內容，不需要標題。
"""
